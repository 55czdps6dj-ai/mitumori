<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>営業見積シミュレーター v2.6</title>
    <style>
        :root { --blue: #00479d; --red: #e60012; --bg: #f8f9fa; --gray: #444; --green: #28a745; }
        body { font-family: -apple-system, sans-serif; background: var(--bg); margin: 0; padding-bottom: 120px; }
        .header { background: var(--blue); color: white; padding: 15px; text-align: center; border-bottom: 3px solid var(--red); position: sticky; top: 0; z-index: 1000; }
        .header h1 { margin: 0; font-size: 1.1rem; }
        .page { display: none; padding: 15px; }
        .page.active { display: block; }
        .section-title { background: var(--gray); color: white; padding: 10px 15px; font-weight: bold; margin-top: 15px; border-radius: 4px; font-size: 0.9rem; }
        .item { display: flex; justify-content: space-between; align-items: center; padding: 12px; background: white; border-bottom: 1px solid #eee; min-height: 50px; }
        .qty-input { width: 70px; height: 40px; text-align: center; border: 1px solid #ccc; font-size: 1.1rem; font-weight: bold; border-radius: 4px; }
        .input-text { width: 110px; padding: 10px; border: 1px solid #ccc; border-radius: 4px; text-align: right; font-size: 1.1rem; }
        .compare-table { width: 100%; border-collapse: collapse; margin-top: 10px; background: white; border-radius: 8px; overflow: hidden; }
        .compare-table th, .compare-table td { border: 1px solid #eee; padding: 12px 8px; text-align: center; }
        .compare-table th { background: #f8f8f8; font-size: 0.8rem; color: #666; }
        .price-val { font-size: 1.2rem; font-weight: bold; color: var(--red); display: block; }
        .highlight-green { color: var(--green) !important; }
        .nav-footer { position: fixed; bottom: 0; width: 100%; background: white; border-top: 2px solid #ccc; padding: 15px; display: flex; justify-content: space-between; box-sizing: border-box; align-items: center; z-index: 1001; }
        .nav-btn { padding: 12px 25px; border-radius: 8px; border: none; font-weight: bold; font-size: 1rem; cursor: pointer; }
        .btn-prev { background: #ccc; }
        .btn-next { background: var(--blue); color: white; }
    </style>
</head>
<body>

<div class="header"><h1 id="page-title">荷物リスト入力</h1></div>

<div id="step1" class="page active"><div id="list-container"></div></div>

<div id="step2" class="page">
    <div class="section-title">エアコン工事</div>
    <div class="item"><span>取り外し</span><input type="number" id="ac-off" class="qty-input" value="0" oninput="updateCalc()"></div>
    <div class="item"><span>取り付け</span><input type="number" id="ac-on" class="qty-input" value="0" oninput="updateCalc()"></div>
    <div class="section-title">実費・経費入力</div>
    <div class="item"><span>養生費</span><input type="number" id="fee-yojo" class="input-text" placeholder="0" oninput="updateCalc()"></div>
    <div class="item"><span>有料道路代</span><input type="number" id="fee-road" class="input-text" placeholder="0" oninput="updateCalc()"></div>
    <div class="item"><span>運送保険料</span><input type="number" id="fee-ins" class="input-text" placeholder="0" oninput="updateCalc()"></div>
</div>

<div id="step3" class="page">
    <div class="section-title">配車確定</div>
    <div class="item"><span>2T車 台数</span><input type="number" id="unit-2t" class="qty-input" value="0" oninput="updateCalc()"></div>
    <div class="item"><span>3T車 台数</span><input type="number" id="unit-3t" class="qty-input" value="0" oninput="updateCalc()"></div>
    <div class="item"><span>作業員数</span><input type="number" id="unit-staff" class="qty-input" value="0" oninput="updateCalc()"></div>
    <div class="section-title">フリー便設定</div>
    <div class="item">
        <span>想定作業時間 (h)</span>
        <input type="number" id="work-time" class="qty-input" value="2.0" step="0.5" oninput="updateCalc()">
    </div>
    <p style="padding:10px; font-size:0.8rem; color:#666;">※時間指定なしの場合、(車両5500+人3250)×時間が割引かれます。</p>
</div>

<div id="step4" class="page">
    <div class="section-title">値引き設定</div>
    <div class="item"><span>基本20%割引</span><input type="checkbox" id="disc-20" style="width:25px; height:25px" onchange="updateCalc()"></div>
    <div class="item"><span>特別値引き(円)</span><input type="number" id="disc-extra" class="input-text" placeholder="0" oninput="updateCalc()"></div>

    <div class="section-title">最終見積比較</div>
    <table class="compare-table">
        <tr><th>プラン</th><th>平日料金</th><th>休日料金</th></tr>
        <tr><th>指定あり</th><td><span id="wd-fixed" class="price-val">0</span>円</td><td><span id="hd-fixed" class="price-val">0</span>円</td></tr>
        <tr><th class="highlight-green">指定なし</th><td><span id="wd-free" class="price-val highlight-green">0</span>円</td><td><span id="hd-free" class="price-val highlight-green">0</span>円</td></tr>
    </table>
</div>

<div class="nav-footer">
    <button class="nav-btn btn-prev" onclick="movePage(-1)">戻る</button>
    <span id="step-indicator">1 / 4</span>
    <button class="nav-btn btn-next" onclick="movePage(1)">次へ</button>
</div>

<script>
let currentPage = 1;
const dataItems = [{n:"ソファー 2人掛け",p:22},{n:"冷蔵庫 5D",p:25},{n:"洗濯機 ドラム",p:12},{n:"タンス",p:18},{n:"ダンボール",p:1}];

function init() {
    const container = document.getElementById('list-container');
    dataItems.forEach((item, i) => {
        const div = document.createElement('div');
        div.className = 'item';
        div.innerHTML = `<span>${item.n}</span><div style="display:flex;gap:10px"><button style="width:40px;height:40px" onclick="chg(${i},-1)">－</button><input type="number" id="q${i}" class="qty-input" value="0" oninput="updateCalc()"><button style="width:40px;height:40px" onclick="chg(${i},1)">＋</button></div>`;
        container.appendChild(div);
    });
    updateCalc();
}
function chg(i, d) { 
    const el = document.getElementById('q'+i); 
    el.value = Math.max(0, (parseInt(el.value)||0)+d); 
    updateCalc(); 
}
function movePage(d) {
    const next = currentPage + d;
    if(next < 1 || next > 4) return;
    document.getElementById(`step${currentPage}`).classList.remove('active');
    document.getElementById(`step${next}`).classList.add('active');
    currentPage = next;
    document.getElementById('step-indicator').innerText = currentPage + ' / 4';
    window.scrollTo(0,0);
}

function updateCalc() {
    const n2t = parseInt(document.getElementById('unit-2t').value) || 0;
    const n3t = parseInt(document.getElementById('unit-3t').value) || 0;
    const nStaff = parseInt(document.getElementById('unit-staff').value) || 0;
    const hTime = parseFloat(document.getElementById('work-time').value) || 0;

    // A: 指定あり基本
    const baseWdFixed = (n2t * 34500) + (n3t * 36500) + (nStaff * 20000);
    const baseHdFixed = (n2t * 44500) + (n3t * 46500) + (nStaff * 30000);

    // B: 指定なし割引額
    const hourlyUnit = ((n2t + n3t) * 5500) + (nStaff * 3250);
    const freeDiscount = hourlyUnit * hTime;

    // 付帯
    const extra = (parseInt(document.getElementById('ac-off').value)||0)*5500 + (parseInt(document.getElementById('ac-on').value)||0)*6500 + (parseInt(document.getElementById('fee-yojo').value)||0) + (parseInt(document.getElementById('fee-road').value)||0) + (parseInt(document.getElementById('fee-ins').value)||0);

    let vals = {
        'wd-fixed': baseWdFixed + extra,
        'hd-fixed': baseHdFixed + extra,
        'wd-free': (baseWdFixed - freeDiscount) + extra,
        'hd-free': (baseHdFixed - freeDiscount) + extra
    };

    const isDisc20 = document.getElementById('disc-20').checked;
    const extraDisc = parseInt(document.getElementById('disc-extra').value) || 0;

    for (let id in vals) {
        let final = vals[id];
        if(isDisc20) final *= 0.8;
        final -= extraDisc;
        document.getElementById(id).innerText = Math.max(0, Math.floor(final)).toLocaleString();
    }
}
init();
</script>
</body>
</html>
